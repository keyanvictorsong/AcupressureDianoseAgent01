<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç©´ä½è¯Šæ–­åŠ©æ‰‹ | Acupressure Diagnosis</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        h1 { color: #667eea; margin-bottom: 10px; }
        .subtitle { color: #666; margin-bottom: 30px; }
        .section { margin-bottom: 30px; }
        .section h2 { color: #333; font-size: 18px; margin-bottom: 15px; border-bottom: 2px solid #667eea; padding-bottom: 5px; }
        .btn-grid { display: flex; flex-wrap: wrap; gap: 10px; }
        .btn {
            padding: 12px 20px;
            border: 2px solid #667eea;
            border-radius: 25px;
            background: white;
            color: #667eea;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        .btn:hover { background: #667eea; color: white; }
        .result {
            background: #f5f5f5;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            display: none;
        }
        .result.show { display: block; }
        .acupoint-card {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #667eea;
        }
        .acupoint-card h3 { color: #667eea; }
        .code {
            background: #667eea;
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 12px;
            margin-right: 8px;
        }
        .images { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; }
        .images img {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 8px;
            cursor: pointer;
        }
        .disclaimer {
            background: #fff3cd;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-size: 13px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ ç©´ä½è¯Šæ–­åŠ©æ‰‹</h1>
        <p class="subtitle">é€‰æ‹©ä½ çš„ç—‡çŠ¶ï¼Œè·å–ç©´ä½æŒ‰æ‘©å»ºè®®</p>

        <div class="section">
            <h2>å¸¸è§ç—‡çŠ¶</h2>
            <div class="btn-grid">
                <button class="btn" onclick="diagnose('headache')">ğŸ¤• å¤´ç—›</button>
                <button class="btn" onclick="diagnose('insomnia')">ğŸ˜´ å¤±çœ </button>
                <button class="btn" onclick="diagnose('anxiety')">ğŸ˜° ç„¦è™‘</button>
                <button class="btn" onclick="diagnose('neck')">ğŸ’† é¢ˆè‚©ç—›</button>
                <button class="btn" onclick="diagnose('low_back_pain')">ğŸ¦´ è…°ç—›</button>
                <button class="btn" onclick="diagnose('nausea')">ğŸ¤¢ æ¶å¿ƒ</button>
            </div>
        </div>

        <div class="result" id="result"></div>

        <div class="disclaimer">
            âš ï¸ æœ¬å·¥å…·ä»…ä¾›å¥åº·å‚è€ƒï¼Œä¸èƒ½æ›¿ä»£ä¸“ä¸šåŒ»ç–—è¯Šæ–­ã€‚å¦‚æœ‰ä¸¥é‡ç—‡çŠ¶è¯·åŠæ—¶å°±åŒ»ã€‚
        </div>
    </div>

    <script>
        const BASE = window.location.origin + window.location.pathname.replace(/\/[^\/]*$/, '');

        async function diagnose(symptom) {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<p>åŠ è½½ä¸­...</p>';
            resultDiv.classList.add('show');

            try {
                const res = await fetch(`${BASE}/api/diagnose/${symptom}.json`);
                const data = await res.json();

                let html = `<h3>é’ˆå¯¹ã€Œ${data.symptom}ã€æ¨èç©´ä½ï¼š</h3>`;

                for (const point of data.acupoints) {
                    // Fetch images
                    let images = [];
                    try {
                        const imgRes = await fetch(`${BASE}/api/images/${point.code}.json`);
                        const imgData = await imgRes.json();
                        images = imgData.images || [];
                    } catch(e) {}

                    html += `
                        <div class="acupoint-card">
                            <h3><span class="code">${point.code}</span>${point.chinese_name || ''} ${point.name}</h3>
                            <p>${point.location_hint || ''}</p>
                            <div class="images">
                                ${images.slice(0, 4).map(img =>
                                    `<img src="${BASE}${img}" onclick="window.open(this.src)" alt="${point.code}">`
                                ).join('')}
                            </div>
                        </div>
                    `;
                }

                resultDiv.innerHTML = html;
            } catch(e) {
                resultDiv.innerHTML = '<p>åŠ è½½å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•</p>';
            }
        }
    </script>
</body>
</html>
